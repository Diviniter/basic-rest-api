var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),BasicRestApi=function(t){function e(e){return t.call(this,new Url(e))||this}return __extends(e,t),e}(ResourceNavigator),__awaiter=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(o,i){function u(t){try{s(n.next(t))}catch(t){i(t)}}function a(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){t.done?o(t.value):new r(function(e){e(t.value)}).then(u,a)}s((n=n.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function r(t){return function(e){return n([t,e])}}function n(r){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,i&&(u=i[2&r[0]?"return":r[0]?"throw":"next"])&&!(u=u.call(i,r[1])).done)return u;switch(i=0,u&&(r=[0,u.value]),r[0]){case 0:case 1:u=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(u=a.trys,!(u=u.length>0&&u[u.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!u||r[1]>u[0]&&r[1]<u[3])){a.label=r[1];break}if(6===r[0]&&a.label<u[1]){a.label=u[1],u=r;break}if(u&&a.label<u[2]){a.label=u[2],a.ops.push(r);break}u[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(t){r=[6,t],i=0}finally{o=u=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var o,i,u,a={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]};return{next:r(0),throw:r(1),return:r(2)}},BaseResource=function(){function t(t){this.url=t,this.requestInit=new RequestInitGenerator}return t.prototype.id=function(t){return new ResourceNavigator(this.url.addId(t))},t.prototype.getAll=function(t){return void 0===t&&(t={}),__awaiter(this,void 0,void 0,function(){var e,r,n;return __generator(this,function(o){switch(o.label){case 0:return e=this.url.toString(),r=this.requestInit.get(t),[4,fetch(e,r)];case 1:return n=o.sent(),[2,this.handleErrorForGetAll(n)]}})})},t.prototype.get=function(t,e){return void 0===e&&(e={}),__awaiter(this,void 0,void 0,function(){var r,n,o;return __generator(this,function(i){switch(i.label){case 0:return r=this.url.addId(t).toString(),n=this.requestInit.get(e),[4,fetch(r,n)];case 1:return o=i.sent(),[2,this.handleError(o)]}})})},t.prototype.save=function(t,e){return void 0===e&&(e={}),__awaiter(this,void 0,void 0,function(){var r,n,o;return __generator(this,function(i){switch(i.label){case 0:return r=this.url.addId(t.id).toString(),n=this.requestInit.put(t,e),[4,fetch(r,n)];case 1:return o=i.sent(),[2,this.handleError(o)]}})})},t.prototype.delete=function(t,e){return void 0===e&&(e={}),__awaiter(this,void 0,void 0,function(){var r,n,o;return __generator(this,function(i){switch(i.label){case 0:return r=this.url.addId(t).toString(),n=this.requestInit.delete(e),[4,fetch(r,n)];case 1:return o=i.sent(),[2,this.handleErrorWithoutReponse(o)]}})})},t.prototype.handleErrorForGetAll=function(t){return t.ok?t.json():Promise.reject(t.statusText)},t.prototype.handleError=function(t){return t.ok&&204!=t.status?t.json():Promise.reject(t.statusText)},t.prototype.handleErrorWithoutReponse=function(t){return t.ok&&204!=t.status?Promise.resolve():Promise.reject(t.statusText)},t}(),__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),__awaiter=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(o,i){function u(t){try{s(n.next(t))}catch(t){i(t)}}function a(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){t.done?o(t.value):new r(function(e){e(t.value)}).then(u,a)}s((n=n.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function r(t){return function(e){return n([t,e])}}function n(r){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,i&&(u=i[2&r[0]?"return":r[0]?"throw":"next"])&&!(u=u.call(i,r[1])).done)return u;switch(i=0,u&&(r=[0,u.value]),r[0]){case 0:case 1:u=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(u=a.trys,!(u=u.length>0&&u[u.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!u||r[1]>u[0]&&r[1]<u[3])){a.label=r[1];break}if(6===r[0]&&a.label<u[1]){a.label=u[1],u=r;break}if(u&&a.label<u[2]){a.label=u[2],a.ops.push(r);break}u[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(t){r=[6,t],i=0}finally{o=u=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var o,i,u,a={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]};return{next:r(0),throw:r(1),return:r(2)}},FileResource=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e.prototype.upload=function(t,e,r){return void 0===e&&(e=function(){}),void 0===r&&(r={}),__awaiter(this,void 0,void 0,function(){var n,o,i;return __generator(this,function(u){switch(u.label){case 0:return n=this.url.addVerb("upload").toString(),o=this.requestInit.postFile(t,r),[4,fetch(n,o)];case 1:return i=u.sent(),e(),[2,this.handleError(i)]}})})},e.prototype.download=function(t,e){return void 0===e&&(e={}),__awaiter(this,void 0,void 0,function(){var r,n,o;return __generator(this,function(i){switch(i.label){case 0:return r=this.url.addId(t).addVerb("download").toString(),n=this.requestInit.getFile(e),[4,fetch(r,n)];case 1:return o=i.sent(),o.ok&&204!=o.status?[2,o.blob()]:[2,Promise.reject(o.statusText)]}})})},e}(BaseResource),__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),__awaiter=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(o,i){function u(t){try{s(n.next(t))}catch(t){i(t)}}function a(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){t.done?o(t.value):new r(function(e){e(t.value)}).then(u,a)}s((n=n.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function r(t){return function(e){return n([t,e])}}function n(r){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,i&&(u=i[2&r[0]?"return":r[0]?"throw":"next"])&&!(u=u.call(i,r[1])).done)return u;switch(i=0,u&&(r=[0,u.value]),r[0]){case 0:case 1:u=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(u=a.trys,!(u=u.length>0&&u[u.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!u||r[1]>u[0]&&r[1]<u[3])){a.label=r[1];break}if(6===r[0]&&a.label<u[1]){a.label=u[1],u=r;break}if(u&&a.label<u[2]){a.label=u[2],a.ops.push(r);break}u[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(t){r=[6,t],i=0}finally{o=u=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var o,i,u,a={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]};return{next:r(0),throw:r(1),return:r(2)}},Resource=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e.prototype.create=function(t,e){return void 0===e&&(e={}),__awaiter(this,void 0,void 0,function(){var r,n,o;return __generator(this,function(i){switch(i.label){case 0:return r=this.url.toString(),n=this.requestInit.post(t,e),[4,fetch(r,n)];case 1:return o=i.sent(),[2,this.handleError(o)]}})})},e}(BaseResource),ResourceNavigator=function(){function t(t){this.url=t}return t.prototype.resource=function(t){return new Resource(this.url.addResource(t))},t.prototype.fileResource=function(t){return new FileResource(this.url.addResource(t))},t}(),Helpers=function(){function t(){}return t.extend=function(t,e){for(var r in e)t[r]=e[r]},t}(),RequestInitGenerator=function(){function t(){}return t.prototype.getJsonHeader=function(t){var e={"Content-Type":"application/json"};return Helpers.extend(t,e),new Headers(e)},t.prototype.get=function(t){return{method:"GET",headers:this.getJsonHeader(t)}},t.prototype.put=function(t,e){return{method:"PUT",headers:this.getJsonHeader(e),body:JSON.stringify(t)}},t.prototype.post=function(t,e){return{method:"POST",headers:this.getJsonHeader(e),body:JSON.stringify(t)}},t.prototype.delete=function(t){return{method:"DELETE",headers:this.getJsonHeader(t)}},t.prototype.postFile=function(t,e){var r=new FormData;return r.append("file",t),{method:"POST",headers:new Headers(e),body:r}},t.prototype.getFile=function(t){return{method:"GET",headers:new Headers(t)}},t}(),Url=function(){function t(t){this.baseUrl=t}return t.prototype.addId=function(e){return new t(this.baseUrl+"/"+e.toString())},t.prototype.addResource=function(e){return new t(this.baseUrl+"/"+e)},t.prototype.addVerb=function(e){return new t(this.baseUrl+"/"+e)},t.prototype.toString=function(){return this.baseUrl},t}();